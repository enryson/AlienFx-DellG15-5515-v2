#include <iostream>
#include "USBDeviceHandler.h"

const uint8_t payload1[] = {
    0x03, 0x21, 0x00, 0x01, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};

//configuraćao de regiao do teclado

const uint8_t payload2[] = {
    0x03, 0x23, 0x01, 0x00, 
    //      esquerda, centro esquerda, centro direita, direita
    0x04, //  0x04,     0x04,   0x04,   0x04,           0x04, 
    0x08, //  0x08,     0x09,   0x08,   0x0a,           0x0b,
    0x09, 
    0x0a, 
    0x0b, 
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};

// esse controla as cores
const uint8_t payload3[] = {
    0x03, 0x24, 0x00, 0x07, 0xd0, 0x00, 0xfa, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
};
const uint8_t payload4[] = {
    0x03, 0x21, 0x00, 0x03, 0x00, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};


int main()
{
    USBDeviceHandler usbHandler(0x187c, 0x0550);

    if (!usbHandler.init())
        return 1;
    if (!usbHandler.open())
        return 1;
    if (!usbHandler.claimInterface(0))
        return 1;

    // Array de payloads
    const uint8_t *payloads[] = {payload1, payload2, payload3, payload4};
    int payload_sizes[] = {sizeof(payload1), sizeof(payload2), sizeof(payload3), sizeof(payload4)};
    int num_payloads = sizeof(payloads) / sizeof(payloads[0]);

    // Loop para enviar múltiplos payloads
    for (int i = 0; i < num_payloads; ++i)
    {
        usbHandler.sendPayload((uint8_t *)payloads[i], payload_sizes[i]);
    }

    usbHandler.releaseInterface(0);
    usbHandler.close();

    return 0;
}
